# (PART) Assessments {-}

# Assessment 2A - Rainfall and streamflow data analysis {-}


Throughout the assignment we should remember that rainfall will be influenced by a number of processes that operate on different space and time scales (see Figure \@ref(fig:image6)).  We will examine these during this exercise.

<center>
```{r image6, echo=FALSE, fig.cap="A guide to the timescales applicable to weather, climate variability and climate change [Pacific Climate Futures](www.pacificclimatefutures.net).", out.width = '80%'}
knitr::include_graphics("images/exercise1A/image5.png")
```
</center>

## Objectives {#A2A_1 -}

By the end of this assignment, you should:

1) Understand how and why rainfall may be changing over time and use statistics and regression to test hypothesis.
2) Know how different modes of climate variability such as IOD and ENSO affect annual rainfall.
3) Be able to elucidate the nature of the relationship between rainfall and streamflow

## Temporal trends in rainfall {#A2A_2 -}

1) Calculate the trend in rainfall for the **last 5 years.**  Copy and paste the annual totals from the PIVOT table (include the year and amount columns) into another sheet.  Select the last 5 years of data and in DATA ANALYSIS start a REGRESSION.  Input the data range. Select “**Line Fit Plots**”.  What did you find and what were you expecting?  Is this long enough for a reliable trend?  Is the relationship really linear – discuss?

2) Calculate the trend in rainfall for **all** years available at the site.  Copy and paste the annual totals from the PIVOT table (include the year and amount columns) into another sheet.  Select the all years of data and INSERT a SCATTER plot.  Add a trend line and “**display the equation**” on the chart.  Add the Pearson correlation coefficient (r^2^) value as well.  Add the information for your site into Table \@ref(tab:table5) (and insert the other class data when you can).

<center>
```{r table5, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
options(kableExtra.html.bsTable = F, knitr.kable.NA = '')
table5 <- read.csv("tables/exercise1A/table5.csv", check.names=FALSE)
kable(table5,"html", escape = F, align = rep('c', 5), caption = "Bureau of Meteorology Automatic Weather Station data and station ID across WA and SWWA. Complete the table for each site.",
      bootstrap_options = "hover") %>%
  kable_styling(table1, bootstrap_options = "hover", "striped",
                full_width = F, position = "center",
                font_size = 12) %>%
  column_spec(1, width_min = "9em") %>%
  column_spec(2, width_min = "9em") %>%
  column_spec(3, width_min = "9em") %>%
  column_spec(4, width_min = "9em") %>%
  column_spec(5, width_min = "9em") %>%
  column_spec(6, width_min = "9em") %>%
  row_spec(1:25, background = 'white') %>%
  scroll_box(width = "100%", height = "515px",
             fixed_thead = FALSE)
```
</center>
<br>

3) What hypothesis can we make about changes in rainfall amount over time?  How do we frame the hypothesis?  What statistical test can we use to test the significance of the hypothesis? Describe the results and conclusions of this analysis. Calculate the appropriate t-value and p-value and enter them also into Table \@ref(tab:table5). 

4) Break into small groups of about 5 and discuss the results of Table \@ref(tab:table5).  Choose a rapporteur to report back at the end of the discussion. Highlight the station where there is a statistically significant slope.  Are there statistically significant changes in rainfall?  Are they consistent across WA?  What may be causing the changes? 

## Spatial patterns in rainfall {#A2A_3 -}

5) Take the information in Table \@ref(tab:table4) and record your values onto the locations of each site on the large class map (whiteboard). Use the maps below to locate your site.  When everyone is finished break back into your groups and discuss the results. Choose a new rapporteur to report back at the end of the discussion. Think about the spatial patterns not the temporal ones (i.e climate modes).  What spatial patterns might you expect and what do you notice?  What may be causing these spatial patterns?

<center>
```{r image7, echo=FALSE, fig.cap="", out.width = '90%'}
knitr::include_graphics("images/exercise1A/image6.png")
```
</center>

## Interannual variability in rainfall {#A2A_4 -}

Here we determine how rainfall correlates with known modes of climate variability (i.e. Indian Ocean Dipole (IOD) and El Nino Southern Oscillation (ENSO)).

Other indicators of temporal variability (look for cyclic patterns).  Does rainfall correlate with known modes of climate variability (i.e. IOD and ENSO using the Southern Oscillation Index (SOI)). SOI is calculated as follows.

<center>
\begin{equation}
\text{SOI} = 10 \frac{P_{\text{diff}} - P_{\text{diffav}}}{SD(P_{\text{diff}})}
(\#eq:exercise-3)
\end{equation}
</center>

Where:

- $P_{\text{diff}}$ = (average Tahiti MSLP for the month) - (average Darwin MSLP for the month)
- $P_{\text{diffav}}$ = long term average of $P_{\text{diff}}$ for the month in question, and
- $SD(P_{\text{diff}})$ = long term standard deciation of $P_{\text{diff}}$ for the month in question.

IOD is calculated by anomalous Sea Surface Temperature gradient between the western equatorial Indian Ocean (50E-70E and 10S-10N) and the south eastern equatorial Indian Ocean (90E-110E and 10S-0N) in units of degrees Kelvin.

We will use the extremely useful [Climate Explorer](https://climexp.knmi.nl/start.cgi?id=someone@somewhere) for the next section.  First you will need to register so you can save data series.  Access the rainfall from the previous site that you used in the previous section. Click on “**Monthly Station Data**” (right hand menu), select "precipitation" from the "GHCN-M (all)" column, search for your station (e.g. type BROOME in the "Select stations" section), and then press "Get stations". If the selection works you will see relevant stations listed, and then click “**get data**”. You will then see graphs and options for further integrating the data. Make a name to save the data (the default should be fine). Click “**Add to list**”.

<center>
<video width="85%" height="85%" controls>
  <source src="images/exercise1A/video4.mp4" type="video/mp4">
</video>
</center>

Now get the first climate index for the IOD called the DMI. Go to “**Monthly climate indices**” and then select DMI. Note any trend and variability in the index.

To correlate the index and rainfall select “**Correlate with other time series**”. And tick your previously saved rainfall timeseries and then press “**Correlate**” and copy the results into Table \@ref(tab:table6).

<center>
<video width="85%" height="85%" controls>
  <source src="images/exercise1A/video5.mp4" type="video/mp4">
</video>
</center>

<br>

<center>
```{r table6, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
options(kableExtra.html.bsTable = F, knitr.kable.NA = '')
table6 <- read.csv("tables/exercise1A/table6.csv", check.names=FALSE)
kable(table6,"html", escape = F, align = rep('c', 5), caption = "Rainfall and climate indices (DMI for IOD and SOI for ENSO) correlations.",
      bootstrap_options = "hover") %>%
  kable_styling(table1, bootstrap_options = "hover", "striped",
                full_width = F, position = "center",
                font_size = 12) %>%
  column_spec(1, width_min = "12em") %>%
  column_spec(2, width_min = "12em") %>%
  column_spec(3, width_min = "12em") %>%
  column_spec(4, width_min = "12em") %>%
  column_spec(5, width_min = "12em") %>%
  row_spec(1:12, background = 'white') %>%
  scroll_box(width = "100%",
             fixed_thead = FALSE)
```
</center>

<br>

6) Break into small groups of about 5 and discuss the results of your correlations. Choose a new rapporteur to report back at the end of the discussion. Highlight any months that have a significant p-value (<0.05). What relationships do you see between rainfall and climate mode and why? Do they correlate in specific seasons? How strong are these correlations really? How are they consistent or different across WA? 

We can do the same exercise except using gridded data (climate data divided into say 0.5 degree spacing using reanalysis information). Click on “**Monthly observations**” and go to **Precipitation CRU TS 0.5**.

<center>
<video width="85%" height="85%" controls>
  <source src="images/exercise1A/video6.mp4" type="video/mp4">
</video>
</center>


We then want to correlate each grid cell on the earth with our climate index (SOI and DMI) to see how the correlations very spatially. Click on “Correlate with a time series” and choose either SOI or DMI. Then click correlate at the bottom and wait (the calculations are being done online and the graph returned for viewing). Do the same for both SOI and DMI.

7) Break into small groups of about 5 and discuss the results of your plots. Choose a new rapporteur to report back at the end of the discussion. For DMI which month had the highest (negative) correlation (copy that plot to your results). What areas of Australia have significant correlations and what time of year? For SOI which month had the highest (positive) correlation (copy that plot to your results). What areas of Australia have significant correlations and what time of year? Does this match with your own rainfall station correlations?

## Relationship between rainfall and runoff {#A2A_5 -}

Examine the relationship between annual rainfall and annual Runoff. Go the [Department of Water](http://wir.water.wa.gov.au/Pages/Water-Information-Reporting.aspx) web site. Use this tool to locate a gauging station near your rainfall site. Add the site to your cart and submit a data request - check that the data is being delivered as a "package of pre-computed reports". You will then be emailed a zip file of the station's data. Ensure the station has 10-20 years of available data for this exercise.

<center>
<video width="85%" height="85%" controls>
  <source src="images/exercise1A/video3.mp4" type="video/mp4">
</video>
</center>

8) Plot a scatter plot of discharge and annual rainfall, add a line to the chart. Break into small groups of about 5 and discuss the results of your plots. Choose a new rapporteur to report back at the end of the discussion. What are the relationships between rainfall and discharge? Are they linear or non- linear and why? Are they consistent across WA? 
